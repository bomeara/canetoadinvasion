---
title: "Cane Toad Invasion"
---

[More information about cane toads in Florida](https://www.smithsonianmag.com/smart-news/plague-invasive-cane-toads-overruns-florida-community-180971797/)

**Investigation**

Using the data set & map, where has the cane toad lived over time?  How did it spread?

**Prediction**

What will happen in the next 5 years?  How will this impact the biodiversity of the area?

**Figures**

There are three figures using information from [GBIF](http://www.gbif.org).

The first is an animated map showing spread of toads over time.


```{r, echo=FALSE, cache=FALSE, include=FALSE}
source("R/packages.R")
source("R/functions.R")
```

```{r, cache = TRUE, echo=FALSE, include=FALSE}
  locations <- GetCaneToadLocations(stateProvince="Florida")
  locations$year <- as.integer(locations$year)
  locations <- locations[which(locations$year>=1934),]
```

```{r, cache = TRUE, echo=FALSE, message=FALSE, warning=FALSE}
fla <- ggplot2::map_data("state", "Florida")
#my_map <- ggplot() + geom_polygon(data = fla, aes(x=long, y = lat, group = group)) + coord_fixed(1.3) + geom_point(data=locations, aes(x=locations$decimalLongitude, y=locations$decimalLatitude), col=rgb(1,0,0,0.4)) + labs(title = 'Year: {frame_time}') + transition_time(year) + ease_aes('linear') + shadow_mark() + theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(), axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank()) + theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank())
my_map <- ggplot() + geom_polygon(data = fla, aes(x=long, y = lat, group = group)) + coord_fixed(1.3) + geom_point(data=locations, aes(x=locations$decimalLongitude, y=locations$decimalLatitude), col=rgb(1,0,0,0.4)) + labs(title = 'Year: {frame_time}') + transition_time(year) + shadow_mark() + theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(), axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank()) + theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank())

animate(my_map, fps=4)
```

```{r, cache = TRUE, echo=FALSE, message=FALSE, warning=FALSE}
years <- seq(from=min(locations$year)-1, to=max(locations$year), by=1)
extents <- as.data.frame(t(sapply(years, GetMaximumDistancesAndArea, locations=locations)))
```

This shows growth of the extent of land occupied: the maximum distance in miles from records at the extreme of the range.

```{r, cache = TRUE, echo=FALSE, message=FALSE, warning=FALSE}
extent.lengths <- data.frame(year=rep(extents$year, 2), miles=c(extents$northsouthdistancemile, extents$eastwestdistancemile), distance=c(rep("North-South", length(extents$northsouthdistancemile)), rep("East-West", length(extents$eastwestdistancemile))))
lengths.plot <- ggplot(data=extent.lengths, aes(x=year, y=miles, group=distance)) + geom_line(aes(color=distance)) + ylab("Miles separating the species at the extreme") + xlab("Year")
print(lengths.plot)
```

This shows growth of the area occupied over time: square miles versus time. Note that this is done by drawing a polygon around all the included points, but there may be areas of the enclosed range that actually do not have cane toads (so this may be an overestimate).

```{r, cache = TRUE, echo=FALSE, message=FALSE, warning=FALSE}
areas.plot <- ggplot(data=extents, aes(x=year, y=areami2)) + geom_line() + ylab("Square miles occupied") + xlab("Year")
print(areas.plot)
```

```{r, cache = TRUE, echo=FALSE, message=FALSE, warning=FALSE}
write.csv(extents, file="./FloridaExtents.csv")
```

You can download the estimates of the spread of the species over time as [FloridaExtents.csv](FloridaExtents.csv).
